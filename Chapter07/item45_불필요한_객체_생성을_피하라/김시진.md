## 아이템45. 불필요한 객체 생성을 피하라
- Int 와 같은 기본형을 사용하면, 일반적으로 기본 자료형 int 로 컴파일 된다.
- 하지만 nullable 로 만들거나, 타입 아규먼트로 사용할 경우에는 Integer 로 컴파일 된다.
- 기본 자료형은 null 일 수 없고, 타입 아규먼트로도 사용할 수 없기 때문이다.
- 객체 생성 비용은 항상 클까?
- 현대 64비트 JDK 에서 객체는 8바이트의 배수만큼 공간을 차지한다.
- 앞부분 12바이트는 헤더로서 반드시 있어야 하므로, 최소 크기는 16바이트이다.
- 추가로 객체에 대한 레퍼런스도 공간을 차지한다.
- 일반적으로 레퍼런스는 -Xmx32G 까지는 32/64비트 플랫폼 모두 4바이트다.
- 64비트 플랫폼에서는 32G(-Xmx32G)부터는 8바이트이다.
- 캐시를 활용하는 팩토리 함수
- 객체 생성이 무겁거나, 동시에 여러 mutable 객체를 사용해야 하는 경우에는 객체 풀을 사용하는 것이 좋다.
- WeakReference
- 가비지 컬렉터가 값을 정리(clean)하는 것을 막지 않는다.
- 따라서 다른 레퍼런스(변수)가 이를 사용하지 않으면 곧바로 제거된다.
- SoftReference
- 가비지 컬렉터가 값을 정리할 수도 있고, 정리하지 않을 수도 있다.
- 일반적인 JVM 구현의 경우, 메모리가 부족해서 추가로 필요한 경우에만 정리한다.
- 따라서 캐시를 만들 때는 SoftReference 를 사용하는 것이 좋다.
- 프로퍼티를 지연되게 만드는 것은 무거운 클래스를 사용할 때 유용하다.
- 기본 자료형을 랩(wrap)한 자료형이 사용되는 경우
- nullable 타입을 연산할 때(기본 자료형은 null 일 수 없으므로)
- 타입을 제네릭으로 사용할 때
- 성능이 중요한 경우라면 함수 안에서 nullable 타입보다는 기본 자료형을 사용하자.